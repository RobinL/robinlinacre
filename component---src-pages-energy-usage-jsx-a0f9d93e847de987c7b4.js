(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{lCpg:function(e,t,n){"use strict";n.r(t);n("q1tI");var i=n("o0o1"),r=n.n(i),a=(n("ls82"),n("HaE+")),o=(n("f3/d"),n("8+KV"),n("h4VS")),u=(n("Z2Ku"),n("L9s1"),n("VRzm"),n("Btvt"),n("0l/t"),n("WLL4"),n("1OyB")),c=n("vuIU");function l(){var e=Object(o.a)(["<input type=number min=0 max=100 step=1>"]);return l=function(){return e},e}function f(){var e=Object(o.a)(["<input type=range min=0 max=100 step=1>"]);return f=function(){return e},e}function s(){var e=Object(o.a)(["Here are two more inputs (of different types!) bound to the same view. Interacting with either view below updates *y* as well as the other synchronized inputs above."]);return s=function(){return e},e}function d(){var e=Object(o.a)(["Since we want multiple controls, instead of duplicating the code above, let‚Äôs now write a reusable function that binds a given input to a given view. We use [Generators.disposable](https://github.com/observablehq/notebook-stdlib/blob/master/README.md#Generators_disposable) to remove the event listener from the view when the calling cell is [invalidated](/@mbostock/disposing-content)."]);return d=function(){return e},e}function v(){var e=Object(o.a)(["<input type=range min=0 max=100 step=1>"]);return v=function(){return e},e}function _(){var e=Object(o.a)(["And now let‚Äôs define an input that both listens to the minimal view and assigns a new value on interaction. Notice that dragging the slider changes the value of *y*."]);return _=function(){return e},e}function h(){var e=Object(o.a)(["Here‚Äôs our view‚Äôs value:"]);return h=function(){return e},e}function p(){var e=Object(o.a)(["Now let‚Äôs define a minimal view whose initial value is 42:"]);return p=function(){return e},e}function m(){var e=Object(o.a)(["While each interactive value is often independent, other times multiple controls manipulate a shared value. This requires synchronizing views such that interaction with any one view updates both the interactive value and the other views.\n\nOne way to synchronize is to treat [views as mutable values](/@mbostock/views-are-mutable-values): make one view the ‚Äúprimary‚Äù view, and have the other ‚Äúsecondary‚Äù views listen to and mutate the primary view. But sometimes it isn‚Äôt obvious which view should be primary.\n\nA more general approach is a *minimal* view: a container for a mutable value that implements the [EventTarget interface](https://developer.mozilla.org/docs/Web/API/EventTarget), making it compatible with `viewof`. This minimal view also exposes a *view*.value property representing its current value; setting the value causes the view to dispatch an *input* event, which in turn causes Observable to [rerun](/@mbostock/how-observable-runs) any referencing cells."],["While each interactive value is often independent, other times multiple controls manipulate a shared value. This requires synchronizing views such that interaction with any one view updates both the interactive value and the other views.\n\nOne way to synchronize is to treat [views as mutable values](/@mbostock/views-are-mutable-values): make one view the ‚Äúprimary‚Äù view, and have the other ‚Äúsecondary‚Äù views listen to and mutate the primary view. But sometimes it isn‚Äôt obvious which view should be primary.\n\nA more general approach is a *minimal* view: a container for a mutable value that implements the [EventTarget interface](https://developer.mozilla.org/docs/Web/API/EventTarget), making it compatible with \\`viewof\\`. This minimal view also exposes a *view*.value property representing its current value; setting the value causes the view to dispatch an *input* event, which in turn causes Observable to [rerun](/@mbostock/how-observable-runs) any referencing cells."]);return m=function(){return e},e}function g(){var e=Object(o.a)(["<input type=range>"]);return g=function(){return e},e}function b(){var e=Object(o.a)(["# Synchronized Views\n\n[A view](/@mbostock/introduction-to-views) conveniently defines an interactive value."]);return b=function(){return e},e}function w(e,t){var n=e.module();return n.variable(t()).define(["md"],(function(e){return e(b())})),n.variable(t("viewof x")).define("viewof x",["html"],(function(e){return e(g())})),n.variable(t("x")).define("x",["Generators","viewof x"],(function(e,t){return e.input(t)})),n.variable(t()).define(["x"],(function(e){return e})),n.variable(t()).define(["md"],(function(e){return e(m())})),n.variable(t("View")).define("View",(function(){return function(){function e(t){Object(u.a)(this,e),Object.defineProperties(this,{_list:{value:[],writable:!0},_value:{value:t,writable:!0}})}return Object(c.a)(e,[{key:"addEventListener",value:function(e,t){"input"!=e||this._list.includes(t)||(this._list=[t].concat(this._list))}},{key:"removeEventListener",value:function(e,t){"input"==e&&(this._list=this._list.filter((function(e){return e!==t})))}},{key:"dispatchEvent",value:function(e){var t=Promise.resolve(e);this._list.forEach((function(e){return t.then(e)}))}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.dispatchEvent({type:"input",value:e})}}]),e}()})),n.variable(t()).define(["md"],(function(e){return e(p())})),n.variable(t("viewof y")).define("viewof y",["View"],(function(e){return new e(42)})),n.variable(t("y")).define("y",["Generators","viewof y"],(function(e,t){return e.input(t)})),n.variable(t()).define(["md"],(function(e){return e(h())})),n.variable(t()).define(["y"],(function(e){return e})),n.variable(t()).define(["md"],(function(e){return e(_())})),n.variable(t()).define(["html","viewof y","invalidation"],(function(e,t,n){var i=e(v());i.oninput=function(){return t.value=i.valueAsNumber};var r=function(){return i.value=t.value};return t.addEventListener("input",r),n.then((function(){return t.removeEventListener("input",r)})),r(),i})),n.variable(t()).define(["md"],(function(e){return e(d())})),n.variable(t("bind")).define("bind",["Generators"],(function(e){return function(t,n){function i(e){var n=e.value;isNaN(n)||t.valueAsNumber===n||(t.value=n)}return t.value=n.value,t.oninput=function(){return n.value=t.valueAsNumber},n.addEventListener("input",i),e.disposable(t,(function(){n.removeEventListener("input",i)}))}})),n.variable(t()).define(["md"],(function(e){return e(s())})),n.variable(t()).define(["bind","html","viewof y"],(function(e,t,n){return e(t(f()),n)})),n.variable(t()).define(["bind","html","viewof y"],(function(e,t,n){return e(t(l()),n)})),n.variable(t()).define(["y"],(function(e){return e})),n}n("XfO3"),n("HEwt");function y(){var e=Object(o.a)(["<span>"]);return y=function(){return e},e}function k(){var e=Object(o.a)(["This is a test; the count should be three.\n\n",""]);return k=function(){return e},e}function x(){var e=Object(o.a)(["# Disposal\n\nThis is a little helper to detect when an element is removed from the DOM. It functions similarly to [invalidation](https://github.com/observablehq/notebook-stdlib/blob/master/README.md#invalidation), except that you don‚Äôt need to pass the invalidation promise around. The downside is that it only works if the resource you want to dispose is attached to a DOM element."]);return x=function(){return e},e}function O(e,t){var n=e.module();return n.variable(t()).define(["md"],(function(e){return e(x())})),n.variable(t("disposal")).define("disposal",["MutationObserver"],(function(e){return function(t){return new Promise((function(n){requestAnimationFrame((function(){var i=t.closest(".observablehq");if(!i)return n();var r=new e((function(e){i.contains(t)||(r.disconnect(),n())}));r.observe(i,{childList:!0})}))}))}})),n.variable(t()).define(["md","test"],(function(e,t){return e(k(),Array.from({length:3},t))})),n.define("initial count",(function(){return 0})),n.variable(t("mutable count")).define("mutable count",["Mutable","initial count"],(function(e,t){return new e(t)})),n.variable(t("count")).define("count",["mutable count"],(function(e){return e.generator})),n.variable(t("test")).define("test",["html","mutable count","disposal"],(function(e,t,n){return function(){var i=e(y());return++t.value,n(i).then((function(){return--t.value})),i}})),n}function j(){var e=Object(o.a)(["To bind a given *input* to a *view*, you need bidirectional listening: the *input* needs to listen to the *view* (to update the *input*‚Äôs value), and the *view* needs to listen to the *input* (to update the *view*‚Äôs value). This is a [disposable view](/@mbostock/disposal)."]);return j=function(){return e},e}function A(){var e=Object(o.a)(["The view‚Äôs value can be referenced reactively:"]);return A=function(){return e},e}function V(){var e=Object(o.a)(["All of these inputs are synchronized using a [view](/@mbostock/synchronized-views):"]);return V=function(){return e},e}function E(){var e=Object(o.a)(["<input type=range>"]);return E=function(){return e},e}function G(){var e=Object(o.a)(["You can also do a standalone input:"]);return G=function(){return e},e}function S(){var e=Object(o.a)(['<input type=number style="width:80px;">']);return S=function(){return e},e}function D(){var e=Object(o.a)(['<input type=range style="width:80px;">']);return D=function(){return e},e}function L(){var e=Object(o.a)(["This is a range input ",".\n\nThis is a number input ","."]);return L=function(){return e},e}function T(){var e=Object(o.a)(["# Inline Inputs\n\nSometimes you might want to put inputs inline in your Markdown, rather than as separate cells. This is a little trickier, but possible, and you can even synchronize multiple inputs if you desire. Here‚Äôs an example:"]);return T=function(){return e},e}function q(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(T())})),n.variable(t()).define(["md","bind","html","viewof apples"],(function(e,t,n,i){return e(L(),t(n(D()),i),t(n(S()),i))})),n.variable(t()).define(["md"],(function(e){return e(G())})),n.variable(t()).define(["bind","html","viewof apples"],(function(e,t,n){return e(t(E()),n)})),n.variable(t()).define(["md"],(function(e){return e(V())})),n.variable(t("viewof apples")).define("viewof apples",["View"],(function(e){return new e(3)})),n.variable(t("apples")).define("apples",["Generators","viewof apples"],(function(e,t){return e.input(t)})),n.variable(t()).define(["md"],(function(e){return e(A())})),n.variable(t()).define(["apples"],(function(e){return new Array(e+1).join("üçé")})),n.variable(t()).define(["md"],(function(e){return e(j())})),n.variable(t("bind")).define("bind",["disposal"],(function(e){return function(t,n){var i=["range","number"].includes(t.type)?"valueAsNumber":"value",r=function(){return t[i]=n.value};return t.oninput=function(){return n.value=t[i]},n.addEventListener("input",r),e(t).then((function(){return n.removeEventListener("input",r)})),r(),t}}));var i=e.module(w);n.import("View",i);var r=e.module(O);return n.import("disposal",r),n}function N(){var e=Object(o.a)(['<select>\n    <option value="minutes">minute</option>\n    <option value="hours">hour</option>\n    <option value="days">day</option>\n    <option value="weeks">week</option>\n    <option value="months">month</option>\n    <option value="years">year</option>\n  </select>']);return N=function(){return e},e}function z(){var e=Object(o.a)(["<input type=",' style="width:',';">']);return z=function(){return e},e}function R(){var e=Object(o.a)(["# Utils"]);return R=function(){return e},e}function I(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(R())})),n.variable(t("inline_input")).define("inline_input",["bind","html"],(function(e,t){return function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"25px";return e(t(z(),i,r),n)}}));var i=e.module(q);return n.import("bind",i),n.import("View",i),n.variable(t("time_period_picker")).define("time_period_picker",["bind","html"],(function(e,t){return function(n){return e(t(N()),n)}})),n}n("DNiP"),n("bHtr"),n("Vd3H"),n("rGqo"),n("yt8O"),n("RW0V"),n("bWfx");function P(){var e=Object(o.a)(['Each full square ( <svg width=16 height=16><rect x="0" y="0" width="16" height="16" fill="#BBB" stroke="gray"></rect></svg> ) in the visualisations represents 1 kilowatt hour (kwh), the amount of energy consumed by using 1000 watts of power for one hour.  ']);return P=function(){return e},e}function M(){var e=Object(o.a)(["<input type=range min=0 max=100 step=0.25>"]);return M=function(){return e},e}function F(){var e=Object(o.a)(["# Unit chart"]);return F=function(){return e},e}function W(e,t){var n=e.module();return n.variable(t()).define(["md"],(function(e){return e(F())})),n.variable(t("d3")).define("d3",["require"],(function(e){return e("d3","d3-scale-chromatic@^1.4.0")})),n.variable(t("data")).define("data",["slider"],(function(e){return{"label a":15.5,"b stuff":42.2,"c another label":e}})),n.variable(t("get_d3_data")).define("get_d3_data",(function(){return function(e){var t=Object.keys(e).map((function(t){return{key:t,value:e[t]}}));return t.sort((function(e,t){return t.value-e.value})),t.map((function(e){var t=e.value,n=Math.ceil(t),i=Array(n).fill(0);return i=i.map((function(n,i){return{key:e.key,value:i+1>t?t-i:1}}))})).flat()}})),n.variable(t("viewof slider")).define("viewof slider",["html"],(function(e){return e(M())})),n.variable(t("slider")).define("slider",["Generators","viewof slider"],(function(e,t){return e.input(t)})),n.variable(t("d3_data")).define("d3_data",["get_d3_data","data"],(function(e,t){return e(t)})),n.variable(t()).define(["unit_chart","data","width"],(function(e,t,n){return e(t,n)})),n.variable(t("unit_chart")).define("unit_chart",["width","get_d3_data","d3","DOM"],(function(e,t,n,i){return function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){a>640&o&&(a=640);var e=t(r),u=0,c=20,l=0,f=0,s=a-f-c,d=e.reduce((function(e,t){return e+t.value}),0),v=Math.floor(s/20),_=20*Math.ceil(d/v),h=v-d%v<7,p=0;h&&(p=20);var m=_+p+u+l-u-l,g=n.scaleOrdinal().range(n.schemeCategory10).domain(["Driving","Flying","Heating","Stuff","Showers","Food/Eating","Washing machine","Dishwasher","Dogs"]),b=n.select(i.svg(s+f+c,m+u+l)),w=b.append("g").attr("transform","translate("+f+","+u+")");w.selectAll("c_rect").data(e).enter().append("rect").attr("x",(function(e,t){return t%v*20})).attr("y",(function(e,t){return 20*Math.floor(t/v)})).attr("width",(function(e){return 16*e.value})).attr("height",16).attr("fill",(function(e){return g(e.key)})),w.selectAll("g_rect").data(e).enter().append("rect").attr("x",(function(e,t){return t%v*20})).attr("y",(function(e,t){return 20*Math.floor(t/v)})).attr("width",(function(e){return 16})).attr("height",16).attr("stroke","gray").attr("stroke-width",.5).attr("fill","none");var y=e.reduce((function(e,t){return e+t.value}),0).toFixed(1)+" kwh/day",k=0;h||(k=(e.length-1)%v*20+20);var x=20*Math.floor((e.length-1)/v);return h&&(x+=20),w.append("text").attr("x",k).attr("dx",2).attr("y",x).attr("dy",10).style("text-anchor","left").style("alignment-baseline","middle").style("font-size","1em").text(y),b.node()}()}})),n.variable(t()).define(["unit_chart_2","data","width"],(function(e,t,n){return e(t,n)})),n.variable(t("unit_chart_2")).define("unit_chart_2",["width","get_d3_data","munge_data","d3","DOM"],(function(e,t,n,i,r){return function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,u=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){o>640&u&&(o=640);var e=t(a),c=0,l=20,f=0,s=100,d=o-s-l,v=(e.reduce((function(e,t){return e+t.value}),0),Math.floor(d/20)),_=n(e,v),h=i.nest().key((function(e){return e.key})).rollup((function(e){return i.extent(e,(function(e){return e.y}))})).entries(_),p=20*(_.slice(-1)[0].y+1)+c+f-c-f,m=i.scaleOrdinal().range(i.schemeCategory10).domain(["Driving","Flying","Heating","Stuff","Showers","Food/Eating","Washing machine","Dishwasher","Dogs"]),g=i.select(r.svg(d+s+l,p+c+f)),b=g.append("g").attr("transform","translate("+s+","+c+")");return b.selectAll("c_rect").data(_).enter().append("rect").attr("x",(function(e){return 20*e.x})).attr("y",(function(e){return 20*e.y})).attr("width",(function(e){return 16*e.value})).attr("height",16).attr("fill",(function(e){return m(e.key)})),b.selectAll("g_rect").data(_).enter().append("rect").attr("x",(function(e){return 20*e.x})).attr("y",(function(e){return 20*e.y})).attr("width",16).attr("height",16).attr("fill",null).attr("stroke","gray").attr("stroke-width",.5).attr("fill","none"),b.selectAll("a_text").data(h).enter().append("text").attr("x",0).attr("dx",-6).attr("y",(function(e){return 20*i.mean(e.value)})).attr("dy",10).style("text-anchor","end").style("alignment-baseline","middle").style("font-size",(function(e){return function(e){return e.key.length<=10?"1rem":10/e.key.length+"rem"}(e)})).text((function(e){return e.key})),g.node()}()}})),n.variable(t("munge_data")).define("munge_data",(function(){return function(e,t){var n=0,i=0,r=e[0].key;return e.map((function(e){return r!=e.key?(i+=1.5,n=0):n>t&&(n=0,i+=1),e.x=n,e.y=i,r=e.key,n+=1,e}))}})),n.variable(t("munged")).define("munged",["munge_data","get_d3_data","data"],(function(e,t,n){return e(t(n),10)})),n.variable(t("text_positions")).define("text_positions",["d3","munged"],(function(e,t){return e.nest().key((function(e){return e.key})).rollup((function(t){return e.extent(t,(function(e){return e.y}))})).entries(t)})),n.variable(t("key")).define("key",["md"],(function(e){return e(P())})),n}function B(){var e=Object(o.a)(["= "," kwh per day"]);return B=function(){return e},e}function H(){var e=Object(o.a)([" You drive an average \n"," \nmiles per \n"," in a vehicle that gets an average of \n","\nmiles per imperial gallon"]);return H=function(){return e},e}function U(){var e=Object(o.a)(["# Driving"]);return U=function(){return e},e}function C(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(U())}));var i=e.module(q);n.import("bind",i),n.import("View",i);var r=e.module(I);n.import("inline_input",r),n.import("time_period_picker",r);var a=e.module(W);return n.import("unit_chart",a),n.variable(t("driving_text")).define("driving_text",["md","inline_input","viewof miles","time_period_picker","viewof miles_driven_period","viewof miles_per_gallon"],(function(e,t,n,i,r,a){return e(H(),t(n,"number","60px"),i(r),t(a,"number","45px"))})),n.variable(t("kwh")).define("kwh",["eu","miles","miles_driven_period","miles_per_gallon"],(function(e,t,n,i){return e.driving.miles_driven_to_kwh_per_day(t,n,i)})),n.variable(t("driving_chart")).define("driving_chart",["unit_chart","kwh"],(function(e,t){return e({Driving:t})})),n.variable(t("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,t){return e.utils.format_kwh(t)})),n.variable(t("driving_conclusion")).define("driving_conclusion",["md","kwh_formatted"],(function(e,t){return e(B(),t)})),n.variable(t("driving_data")).define("driving_data",["kwh"],(function(e){return[{name:"Driving",value:e}]})),n.variable(t("viewof miles")).define("viewof miles",["View"],(function(e){return new e(1e4)})),n.variable(t("miles")).define("miles",["Generators","viewof miles"],(function(e,t){return e.input(t)})),n.variable(t("viewof miles_per_gallon")).define("viewof miles_per_gallon",["View"],(function(e){return new e(45)})),n.variable(t("miles_per_gallon")).define("miles_per_gallon",["Generators","viewof miles_per_gallon"],(function(e,t){return e.input(t)})),n.variable(t("viewof miles_driven_period")).define("viewof miles_driven_period",["View"],(function(e){return new e("years")})),n.variable(t("miles_driven_period")).define("miles_driven_period",["Generators","viewof miles_driven_period"],(function(e,t){return e.input(t)})),n.variable(t("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.22")})),n}function Y(){var e=Object(o.a)(["= "," kwh per day"]);return Y=function(){return e},e}function K(){var e=Object(o.a)([" You fly an average of\n"," \nmiles per \n","\nin economy class.  (Business class/first class would probably be double this or more)\n"]);return K=function(){return e},e}function Q(){var e=Object(o.a)(["# Flying"]);return Q=function(){return e},e}function J(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(Q())}));var i=e.module(q);n.import("bind",i),n.import("View",i);var r=e.module(I);n.import("inline_input",r),n.import("time_period_picker",r),n.variable(t("flying_text")).define("flying_text",["md","inline_input","viewof miles","time_period_picker","viewof miles_flown_period"],(function(e,t,n,i,r){return e(K(),t(n,"number","60px"),i(r))})),n.variable(t("kwh")).define("kwh",["eu","miles","miles_flown_period"],(function(e,t,n){return e.flying.flying_miles_to_kwh(t,n)})),n.variable(t("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,t){return e.utils.format_kwh(t)})),n.variable(t("flying_conclusion")).define("flying_conclusion",["md","kwh_formatted"],(function(e,t){return e(Y(),t)})),n.variable(t("flying_chart")).define("flying_chart",["unit_chart","kwh"],(function(e,t){return e({Flying:t})})),n.variable(t("flying_data")).define("flying_data",["kwh"],(function(e){return[{name:"Flying",value:e}]})),n.variable(t("viewof miles")).define("viewof miles",["View"],(function(e){return new e(12e3)})),n.variable(t("miles")).define("miles",["Generators","viewof miles"],(function(e,t){return e.input(t)})),n.variable(t("viewof miles_flown_period")).define("viewof miles_flown_period",["View"],(function(e){return new e("years")})),n.variable(t("miles_flown_period")).define("miles_flown_period",["Generators","viewof miles_flown_period"],(function(e,t){return e.input(t)})),n.variable(t("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.22")}));var a=e.module(W);return n.import("unit_chart",a),n}function Z(){var e=Object(o.a)(["= "," kwh per day"]);return Z=function(){return e},e}function X(){var e=Object(o.a)([" Your energy bill says you use \n"," KWh of electricity\nper year and there are \n"," \npeople in your household.\n"]);return X=function(){return e},e}function $(){var e=Object(o.a)(["# Electricity"]);return $=function(){return e},e}function ee(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e($())}));var i=e.module(q);n.import("bind",i),n.import("View",i);var r=e.module(I);n.import("inline_input",r),n.import("time_period_picker",r),n.variable(t("electricity_text")).define("electricity_text",["md","inline_input","viewof actual_usage_from_bill","viewof num_occupants"],(function(e,t,n,i){return e(X(),t(n,"number","60px"),t(i,"number","45px"))})),n.variable(t("kwh")).define("kwh",["eu","actual_usage_from_bill","num_occupants"],(function(e,t,n){return e.electricity.electricity_kwh_per_day(t,n)})),n.variable(t("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,t){return e.utils.format_kwh(t)})),n.variable(t("electricity_conclusion")).define("electricity_conclusion",["md","kwh_formatted"],(function(e,t){return e(Z(),t)})),n.variable(t("electricity_chart")).define("electricity_chart",["unit_chart","kwh"],(function(e,t){return e({Electricity:t})})),n.variable(t("electricity_data")).define("electricity_data",["kwh"],(function(e){return[{name:"Electricity",value:e}]})),n.variable(t("viewof actual_usage_from_bill")).define("viewof actual_usage_from_bill",["View"],(function(e){return new e(1800)})),n.variable(t("actual_usage_from_bill")).define("actual_usage_from_bill",["Generators","viewof actual_usage_from_bill"],(function(e,t){return e.input(t)})),n.variable(t("viewof num_occupants")).define("viewof num_occupants",["View"],(function(e){return new e(2)})),n.variable(t("num_occupants")).define("num_occupants",["Generators","viewof num_occupants"],(function(e,t){return e.input(t)})),n.variable(t("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.1.7")}));var a=e.module(W);return n.import("unit_chart",a),n}function te(){var e=Object(o.a)(["= "," kwh per day"]);return te=function(){return e},e}function ne(){var e=Object(o.a)([" You have \n"," \ndog(s) who weigh \n"," \nkg each (on average)\n"]);return ne=function(){return e},e}function ie(){var e=Object(o.a)(["# Pets"]);return ie=function(){return e},e}function re(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(ie())}));var i=e.module(q);n.import("bind",i),n.import("View",i);var r=e.module(I);n.import("inline_input",r),n.import("time_period_picker",r),n.variable(t("dogs_text")).define("dogs_text",["md","inline_input","viewof num_dogs","viewof dogs_weight_kg"],(function(e,t,n,i){return e(ne(),t(n,"number","30px"),t(i,"number","50px"))})),n.variable(t("kwh")).define("kwh",["num_dogs","eu","dogs_weight_kg"],(function(e,t,n){return e*t.pets.kwh_required_by_dogs_per_day(n)})),n.variable(t("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,t){return e.utils.format_kwh(t)})),n.variable(t("dogs_chart")).define("dogs_chart",["unit_chart","kwh"],(function(e,t){return e({Dogs:t})})),n.variable(t("dogs_conclusion")).define("dogs_conclusion",["md","kwh_formatted"],(function(e,t){return e(te(),t)})),n.variable(t("dogs_data")).define("dogs_data",["kwh"],(function(e){return[{name:"Dogs",value:e}]})),n.variable(t("viewof num_dogs")).define("viewof num_dogs",["View"],(function(e){return new e(1)})),n.variable(t("num_dogs")).define("num_dogs",["Generators","viewof num_dogs"],(function(e,t){return e.input(t)})),n.variable(t("viewof dogs_weight_kg")).define("viewof dogs_weight_kg",["View"],(function(e){return new e(15)})),n.variable(t("dogs_weight_kg")).define("dogs_weight_kg",["Generators","viewof dogs_weight_kg"],(function(e,t){return e.input(t)})),n.variable(t("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.22")}));var a=e.module(W);return n.import("unit_chart",a),n}function ae(){var e=Object(o.a)(['<select>\n    <option value="omnivore">Omnivore</option>\n    <option value="vegetarian">Vegetarian</option>\n    <option value="vegan">Vegan</option>\n  </select>']);return ae=function(){return e},e}function oe(){var e=Object(o.a)(['<select>\n    <option value="male">Male</option>\n    <option value="female">Female</option>\n  </select>']);return oe=function(){return e},e}function ue(){var e=Object(o.a)(['<select>\n    <option value="sedentary_light">Sedentary/lightly active</option>\n    <option value="moderately_active">Moderately active</option>\n    <option value="vigorous">Vigorous</option>\n  </select>']);return ue=function(){return e},e}function ce(){var e=Object(o.a)(["= "," kwh per day"]);return ce=function(){return e},e}function le(){var e=Object(o.a)([" You have a "," \nlifestyle, and your diet type is \n","\n"]);return le=function(){return e},e}function fe(){var e=Object(o.a)([" You are \n"," \ncm high, \nyou are \n"," \nyears old,\nyou weigh\n"," \nkg,\nyou're\n"," \nand you have a \n"," \nlifestyle, and your diet type is \n","\n"]);return fe=function(){return e},e}function se(){var e=Object(o.a)(["# Eating"]);return se=function(){return e},e}function de(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(se())}));var i=e.module(q);n.import("bind",i),n.import("View",i);var r=e.module(I);n.import("inline_input",r),n.import("time_period_picker",r),n.variable(t("eating_text_more")).define("eating_text_more",["md","inline_input","viewof height_cm","viewof age_years","viewof weight_kg","gender_picker","viewof gender","activity_level_picker","viewof activity_level","diet_picker","viewof diet_type"],(function(e,t,n,i,r,a,o,u,c,l,f){return e(fe(),t(n,"number","3rem"),t(i,"number","3rem"),t(r,"number","60px"),a(o),u(c),l(f))})),n.variable(t("eating_text")).define("eating_text",["md","activity_level_picker","viewof activity_level","diet_picker","viewof diet_type"],(function(e,t,n,i,r){return e(le(),t(n),i(r))})),n.variable(t("kwh")).define("kwh",["eu","activity_level","diet_type"],(function(e,t,n){return e.eating.kwh_per_day(84,165,40,"Female",t,n)})),n.variable(t("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,t){return e.utils.format_kwh(t)})),n.variable(t("eating_chart")).define("eating_chart",["unit_chart","kwh"],(function(e,t){return e({"Food/Eating":t})})),n.variable(t("eating_conclusion")).define("eating_conclusion",["md","kwh_formatted"],(function(e,t){return e(ce(),t)})),n.variable(t("eating_data")).define("eating_data",["kwh"],(function(e){return[{name:"Food/Eating",value:e}]})),n.variable(t("viewof weight_kg")).define("viewof weight_kg",["View"],(function(e){return new e(68)})),n.variable(t("weight_kg")).define("weight_kg",["Generators","viewof weight_kg"],(function(e,t){return e.input(t)})),n.variable(t("viewof height_cm")).define("viewof height_cm",["View"],(function(e){return new e(178)})),n.variable(t("height_cm")).define("height_cm",["Generators","viewof height_cm"],(function(e,t){return e.input(t)})),n.variable(t("viewof age_years")).define("viewof age_years",["View"],(function(e){return new e(34)})),n.variable(t("age_years")).define("age_years",["Generators","viewof age_years"],(function(e,t){return e.input(t)})),n.variable(t("viewof gender")).define("viewof gender",["View"],(function(e){return new e("male")})),n.variable(t("gender")).define("gender",["Generators","viewof gender"],(function(e,t){return e.input(t)})),n.variable(t("viewof activity_level")).define("viewof activity_level",["View"],(function(e){return new e("moderately_active")})),n.variable(t("activity_level")).define("activity_level",["Generators","viewof activity_level"],(function(e,t){return e.input(t)})),n.variable(t("viewof diet_type")).define("viewof diet_type",["View"],(function(e){return new e("omnivore")})),n.variable(t("diet_type")).define("diet_type",["Generators","viewof diet_type"],(function(e,t){return e.input(t)})),n.variable(t("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.25")})),n.variable(t("activity_level_picker")).define("activity_level_picker",["bind","html"],(function(e,t){return function(n){return e(t(ue()),n)}})),n.variable(t("gender_picker")).define("gender_picker",["bind","html"],(function(e,t){return function(n){return e(t(oe()),n)}})),n.variable(t("diet_picker")).define("diet_picker",["bind","html"],(function(e,t){return function(n){return e(t(ae()),n)}}));var a=e.module(W);return n.import("unit_chart",a),n}function ve(){var e=Object(o.a)(['<select>\n    <option value="kwh">kwh</option>\n    <option value="imperial_gas_units">Imperial units (100s of cubic feet)</option>\n    <option value="metric_gas_units">Metrics units</option>\n  </select>']);return ve=function(){return e},e}function _e(){var e=Object(o.a)(["= "," kwh per day"]);return _e=function(){return e},e}function he(){var e=Object(o.a)(["\nYou take \n"," \nshower(s) a day averaging \n"," \nminutes with water flow of \n","\nml per second.\n\nYou have \n"," \nbath(s) a day, each one of which contains \n"," litres of water.\n"]);return he=function(){return e},e}function pe(){var e=Object(o.a)(["## Need to take out showers and baths from heating"]);return pe=function(){return e},e}function me(){var e=Object(o.a)([" Your energy bill says you use \n"," \n"," \nper year and there are \n"," \npeople in your household.\n\n\n"]);return me=function(){return e},e}function ge(){var e=Object(o.a)(["# Heating and gas"]);return ge=function(){return e},e}function be(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(ge())}));var i=e.module(q);n.import("bind",i),n.import("View",i);var r=e.module(I);n.import("inline_input",r),n.variable(t("heating_text")).define("heating_text",["md","inline_input","viewof actual_usage_from_bill","units_picker","viewof bill_units","viewof num_occupants"],(function(e,t,n,i,r,a){return e(me(),t(n,"number","60px"),i(r),t(a,"number","45px"))})),n.variable(t()).define(["md"],(function(e){return e(pe())})),n.variable(t("showers_and_baths_text")).define("showers_and_baths_text",["md","inline_input","viewof num_showers","viewof shower_minutes","viewof shower_flow","viewof num_baths","viewof bath_litres"],(function(e,t,n,i,r,a,o){return e(he(),t(n,"number","30px"),t(i,"number","30px"),t(r,"number","45px"),t(a,"number","30px"),t(o,"number","45px"))})),n.variable(t("heating_kwh")).define("heating_kwh",["eu","actual_usage_from_bill","num_occupants","bill_units","showers_kwh","baths_kwh"],(function(e,t,n,i,r,a){return e.heating.heating_kwh_per_day(t,19,19,n,i)-r-a})),n.variable(t("showers_kwh")).define("showers_kwh",["eu","num_showers","shower_flow","shower_minutes"],(function(e,t,n,i){return e.shower_bath.shower_get_daily_kwh(t,n,i)})),n.variable(t("baths_kwh")).define("baths_kwh",["eu","num_baths","bath_litres"],(function(e,t,n){return e.shower_bath.bath_get_daily_kwh(t,n)})),n.variable(t("kwh_formatted")).define("kwh_formatted",["eu","heating_kwh"],(function(e,t){return e.utils.format_kwh(t)})),n.variable(t("heating_conclusion")).define("heating_conclusion",["md","kwh_formatted"],(function(e,t){return e(_e(),t)})),n.variable(t("heating_gas_data")).define("heating_gas_data",["heating_kwh","showers_kwh","baths_kwh"],(function(e,t,n){return[{name:"Heating",value:e},{name:"Showers",value:t},{name:"Baths",value:n}]})),n.variable(t("heating_chart")).define("heating_chart",["unit_chart","heating_kwh"],(function(e,t){return e({Heating:t})})),n.variable(t("showers_bath_chart")).define("showers_bath_chart",["unit_chart","showers_kwh","baths_kwh"],(function(e,t,n){return e({Showers:t,Baths:n})})),n.variable(t("viewof actual_usage_from_bill")).define("viewof actual_usage_from_bill",["View"],(function(e){return new e(597)})),n.variable(t("actual_usage_from_bill")).define("actual_usage_from_bill",["Generators","viewof actual_usage_from_bill"],(function(e,t){return e.input(t)})),n.variable(t("viewof bill_units")).define("viewof bill_units",["View"],(function(e){return new e("metric_gas_units")})),n.variable(t("bill_units")).define("bill_units",["Generators","viewof bill_units"],(function(e,t){return e.input(t)})),n.variable(t("viewof num_occupants")).define("viewof num_occupants",["View"],(function(e){return new e(2)})),n.variable(t("num_occupants")).define("num_occupants",["Generators","viewof num_occupants"],(function(e,t){return e.input(t)})),n.variable(t("viewof num_showers")).define("viewof num_showers",["View"],(function(e){return new e(2)})),n.variable(t("num_showers")).define("num_showers",["Generators","viewof num_showers"],(function(e,t){return e.input(t)})),n.variable(t("viewof num_baths")).define("viewof num_baths",["View"],(function(e){return new e(0)})),n.variable(t("num_baths")).define("num_baths",["Generators","viewof num_baths"],(function(e,t){return e.input(t)})),n.variable(t("viewof shower_minutes")).define("viewof shower_minutes",["View"],(function(e){return new e(4)})),n.variable(t("shower_minutes")).define("shower_minutes",["Generators","viewof shower_minutes"],(function(e,t){return e.input(t)})),n.variable(t("viewof shower_flow")).define("viewof shower_flow",["View"],(function(e){return new e(135)})),n.variable(t("shower_flow")).define("shower_flow",["Generators","viewof shower_flow"],(function(e,t){return e.input(t)})),n.variable(t("viewof bath_litres")).define("viewof bath_litres",["View"],(function(e){return new e(150)})),n.variable(t("bath_litres")).define("bath_litres",["Generators","viewof bath_litres"],(function(e,t){return e.input(t)})),n.variable(t("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.1.9")})),n.variable(t("units_picker")).define("units_picker",["bind","html"],(function(e,t){return function(n){return e(t(ve()),n)}}));var a=e.module(W);return n.import("unit_chart",a),n}function we(){var e=Object(o.a)(["= "," kwh per day"]);return we=function(){return e},e}function ye(){var e=Object(o.a)([" You spend an average of \n¬£ "," \nper ","\non 'stuff'.\n\n('Stuff' includes things like clothes, electronics, white goods and cars, but excludes items otherwise accounted for such as food, petrol and flights)\n"]);return ye=function(){return e},e}function ke(){var e=Object(o.a)(["# Stuff"]);return ke=function(){return e},e}function xe(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(ke())}));var i=e.module(q);n.import("bind",i),n.import("View",i);var r=e.module(I);n.import("inline_input",r),n.import("time_period_picker",r),n.variable(t("stuff_text")).define("stuff_text",["md","inline_input","viewof spending","time_period_picker","viewof spending_time_period"],(function(e,t,n,i,r){return e(ye(),t(n,"number","60px"),i(r))})),n.variable(t("kwh")).define("kwh",["eu","spending","spending_time_period"],(function(e,t,n){return e.stuff.pounds_sterling_to_kwh(t)/e.convert.convert_units(n,"days")})),n.variable(t("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,t){return e.utils.format_kwh(t)})),n.variable(t("stuff_conclusion")).define("stuff_conclusion",["md","kwh_formatted"],(function(e,t){return e(we(),t)})),n.variable(t("stuff_chart")).define("stuff_chart",["unit_chart","kwh"],(function(e,t){return e({Stuff:t})})),n.variable(t("stuff_data")).define("stuff_data",["kwh"],(function(e){return[{name:"Stuff",value:e}]})),n.variable(t("viewof spending")).define("viewof spending",["View"],(function(e){return new e(500)})),n.variable(t("spending")).define("spending",["Generators","viewof spending"],(function(e,t){return e.input(t)})),n.variable(t("viewof spending_time_period")).define("viewof spending_time_period",["View"],(function(e){return new e("months")})),n.variable(t("spending_time_period")).define("spending_time_period",["Generators","viewof spending_time_period"],(function(e,t){return e.input(t)})),n.variable(t("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.31")}));var a=e.module(W);return n.import("unit_chart",a),n}n("KKXr");function Oe(){var e=Object(o.a)(["You use a total of __"," kilowatt hours__ of energy a day from the activities covered on this webpage. This means your average power consumption is "," watts. "]);return Oe=function(){return e},e}function je(){var e=Object(o.a)(["# Energy usage treemap and summary"]);return je=function(){return e},e}function Ae(e,t){var n=e.module();return n.variable(t()).define(["md"],(function(e){return e(je())})),n.variable(t("summary_text")).define("summary_text",["get_total","md","format"],(function(e,t,n){return function(i){var r=e(i),a=r/24*1e3;return t(Oe(),n(r),n(a))}})),n.variable(t("get_total")).define("get_total",(function(){return function(e){return e.reduce((function(e,t){return e+t.value}),0)}})),n.variable(t("my_data")).define("my_data",(function(){return[{name:"Showers",value:2.5104},{name:"Driving",value:26.293975646879755},{name:"Flying",value:13.425863835616436},{name:"Washing machine",value:4.2},{name:"Dishwasher",value:.6},{name:"Food/Eating",value:23.303485333333334},{name:"Dogs",value:.86730602373828}]})),n.variable(t()).define(["treemap_chart","my_data"],(function(e,t){return e(t)})),n.variable(t("treemap_chart")).define("treemap_chart",["treemap","d3","grid_size","format","DOM","per_fmt"],(function(e,t,n,i,r,a){return function(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:640,c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];u>640&c&&(u=640);var l={name:"root",children:o},f=e(l,u),s=t.scaleOrdinal().range(t.schemeCategory10).domain(["Driving","Flying","Heating","Stuff","Showers","Food/Eating","Washing machine","Dishwasher","Dogs"]),d=o.reduce((function(e,t){return e+t.value}),0),v=n*n*d,_=v/u;console.log(d),console.log(v),console.log(_),console.log(u);var h=t.create("svg").attr("width",u).attr("height",_).style("font","10px sans-serif"),p=h.selectAll("g").data(f.leaves()).join("g").attr("transform",(function(e){return"translate(".concat(e.x0,",").concat(e.y0,")")}));return p.append("title").text((function(e){return"".concat(e.ancestors().reverse().map((function(e){return e.data.name})).join("/"),"\n").concat(i(e.value))})),p.append("rect").attr("id",(function(e){return(e.leafUid=r.uid("leaf")).id})).attr("fill",(function(e){for(;e.depth>1;)e=e.parent;return s(e.data.name)})).attr("fill-opacity",.7).attr("width",(function(e){return e.x1-e.x0})).attr("height",(function(e){return e.y1-e.y0})),p.append("clipPath").attr("id",(function(e){return(e.clipUid=r.uid("clip")).id})).append("use").attr("xlink:href",(function(e){return e.leafUid.href})),p.append("text").attr("clip-path",(function(e){return e.clipUid})).selectAll("tspan").data((function(e){return e.data.name.split(/(?=[A-Z][^A-Z])/g).concat(i(e.value)+" kwh").concat(a(e.value/e.parent.value))})).join("tspan").attr("x",3).attr("y",(function(e,t,n){return"".concat(.3*(t===n.length-1)+1.1+.9*t,"em")})).attr("fill-opacity",(function(e,t,n){return t===n.length-1?.7:null})).text((function(e){return e})),h.node()}})),n.variable(t("grid_size")).define("grid_size",(function(){return 22})),n.variable(t("treemap")).define("treemap",["grid_size","d3"],(function(e,t){return function(n,i){var r=n.children.reduce((function(e,t){return e+t.value}),0),a=e*e*r,o=a/i;return console.log("-- from treemap"),console.log(r),console.log(a),console.log(o),console.log("--"),t.treemap().tile(t.treemapBinary).size([i,o]).padding(1).round(!0)(t.hierarchy(n).sum((function(e){return e.value})).sort((function(e,t){return t.value-e.value})))}})),n.variable(t("format")).define("format",["d3"],(function(e){return e.format(",.3r")})),n.variable(t("per_fmt")).define("per_fmt",["d3"],(function(e){return e.format(",.1%")})),n.variable(t("color")).define("color",["d3"],(function(e){return e.scaleOrdinal(e.schemeCategory10)})),n.variable(t("d3")).define("d3",["require"],(function(e){return e("d3@5")})),n}var Ve=n("ODXe");function Ee(){var e=Object(o.a)(["## Parallel Coordinates\n\nA [parallel coordinates plot](https://en.wikipedia.org/wiki/Parallel_coordinates) that uses `window` and `fold` transforms to convert the four dimensions of Iris flower measurements into normalized coordinates that can be visualized as `line` marks. The graphic includes an additional layer with custom `text` mark labels for the parallel axis grid lines. We render the plot as SVG by passing `{renderer:'svg'}` to the `render` method.\n"],["## Parallel Coordinates\n\nA [parallel coordinates plot](https://en.wikipedia.org/wiki/Parallel_coordinates) that uses \\`window\\` and \\`fold\\` transforms to convert the four dimensions of Iris flower measurements into normalized coordinates that can be visualized as \\`line\\` marks. The graphic includes an additional layer with custom \\`text\\` mark labels for the parallel axis grid lines. We render the plot as SVG by passing \\`{renderer:'svg'}\\` to the \\`render\\` method.\n"]);return Ee=function(){return e},e}function Ge(){var e=Object(o.a)(["## Interactive Seattle Weather 2012-2015\n\nA scatter plot and summary histogram with linked `selections` between plots to perform cross-filtering and configure conditional color encodings.\n"],["## Interactive Seattle Weather 2012-2015\n\nA scatter plot and summary histogram with linked \\`selections\\` between plots to perform cross-filtering and configure conditional color encodings.\n"]);return Ge=function(){return e},e}function Se(){var e=Object(o.a)(["## Zip Codes\n\nA dot for each zip code in the United States, colored by the first digit.\n"]);return Se=function(){return e},e}function De(){var e=Object(o.a)(["To use the same setup in your own notebooks, add a cell with the following code:\n~~~ js\nimport {vl} from '@vega/vega-lite-api'\n~~~\n"]);return De=function(){return e},e}function Le(){var e=Object(o.a)(["\nThe cell below imports the Vega-Lite API and registers the desired versions of Vega and Vega-Lite, along with default [Vega View options](https://vega.github.io/vega/docs/api/view/#view) and [Vega-Lite configuration](https://vega.github.io/vega-lite/docs/config.html):\n"]);return Le=function(){return e},e}function Te(){var e=Object(o.a)(["The [Vega-Lite JavaScript API](https://github.com/vega/vega-lite-api/) provides a convenient way to write [Vega-Lite](https://vega.github.io/vega-lite) specifications in a programmatic fashion. Scroll down for some usage examples, or browse the [Vega-Lite API example collection](https://observablehq.com/collection/@vega/vega-lite-api)!"]);return Te=function(){return e},e}function qe(){var e=Object(o.a)(["# Vega-Lite API"]);return qe=function(){return e},e}function Ne(e,t){var n=e.module();return n.variable(t()).define(["md"],(function(e){return e(qe())})),n.variable(t()).define(["md"],(function(e){return e(Te())})),n.variable(t()).define(["md"],(function(e){return e(Le())})),n.variable(t("vl")).define("vl",["require"],function(){var e=Object(a.a)(r.a.mark((function e(t){var n,i,a,o,u,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(["vega@5","vega-lite@3.4.0","vega-lite-api@0.1.0","vega-tooltip@0.17.0"].map((function(e){return t(e)})));case 2:return n=e.sent,i=Object(Ve.a)(n,4),a=i[0],o=i[1],u=i[2],c=i[3],l={config:{config:{view:{width:400,height:300},mark:{tooltip:null}}},init:function(e){e.tooltip((new c.Handler).call),e.container()&&(e.container().style["overflow-x"]="auto")},view:{loader:a.loader({baseURL:"https://vega.github.io/vega-datasets/"}),renderer:"canvas"}},e.abrupt("return",u.register(a,o,l));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.variable(t()).define(["md"],(function(e){return e(De())})),n.variable(t()).define(["md"],(function(e){return e(Se())})),n.variable(t()).define(["vl","width"],(function(e,t){return e.markSquare({size:2,opacity:1}).data("data/zipcodes.csv").transform(e.calculate("substring(datum.zip_code, 0, 1)").as("digit")).project(e.projection("albersUsa")).encode(e.longitude().fieldQ("longitude"),e.latitude().fieldQ("latitude"),e.color().fieldN("digit")).width(t).height(Math.floor(t/1.75)).autosize({type:"fit-x",contains:"padding"}).config({view:{stroke:null}}).render()})),n.variable(t()).define(["md"],(function(e){return e(Ge())})),n.variable(t()).define(["vl","width"],(function(e,t){var n=e.selectInterval().encodings("x"),i=e.selectMulti().encodings("color"),r={domain:["sun","fog","drizzle","rain","snow"],range:["#e7ba52","#a7a7a7","#aec7e8","#1f77b4","#9467bd"]},a=e.markPoint({filled:!0}).encode(e.color().value("lightgray").if(n,e.color().fieldN("weather").scale(r).title("Weather")),e.size().fieldQ("precipitation").scale({domain:[-1,50],range:[10,500]}).title("Precipitation"),e.order().fieldQ("precipitation").sort("descending"),e.x().timeMD("date").axis({title:"Date",format:"%b"}),e.y().fieldQ("temp_max").scale({domain:[-5,40]}).axis({title:"Maximum Daily Temperature (¬∞C)"})).width(t).height(300).select(n).transform(e.filter(i)),o=e.markBar().encode(e.color().value("lightgray").if(i,e.color().fieldN("weather").scale(r).title("Weather")),e.x().count(),e.y().fieldN("weather").scale({domain:r.domain}).title("Weather")).width(t).select(i).transform(e.filter(n));return e.vconcat(a,o).data("data/seattle-weather.csv").autosize({type:"fit-x",contains:"padding"}).render()})),n.variable(t()).define(["md"],(function(e){return e(Ee())})),n.variable(t()).define(["vl","width"],(function(e,t){var n=e.markLine({strokeWidth:1.5,opacity:.5}).encode(e.color().fieldN("species").sort("descending"),e.detail().fieldN("index"),e.x().fieldO("key").scale({type:"point",padding:0}).axis({domain:!1,ticks:!1,title:!1,grid:!0,gridColor:"#888",labelAngle:0,labelPadding:8,labelFontWeight:"bold"}),e.y().fieldQ("fraction").axis(null)),i=e.markText({dx:-2,align:"right",baseline:"middle"}).transform(e.groupby("key").aggregate(e.min("value").as("min"),e.max("value").as("max")),e.fold("min","max").as("op","value"),e.groupby("key").window(e.percent_rank("value").as("fraction"))).encode(e.x().fieldN("key"),e.y().fieldQ("fraction").axis(null),e.text().fieldN("value"));return e.layer(n,i).data("data/iris.json").transform(e.window(e.row_number().as("index")),e.fold(["petalLength","petalWidth","sepalLength","sepalWidth"]),e.groupby("key").join(e.min("value").as("min"),e.max("value").as("max")),e.calculate("(datum.value - datum.min) / (datum.max - datum.min)").as("fraction")).width(t).height(300).autosize({type:"fit-x",contains:"padding"}).render({renderer:"svg"})})),n}function ze(){var e=Object(o.a)(["Data comes from a custom report generated from the World Development Indicators, [here](https://databank.worldbank.org/reports.aspx?source=world-development-indicators#)"]);return ze=function(){return e},e}function Re(){var e=Object(o.a)(["https://datacatalog.worldbank.org/energy-use-kg-oil-equivalent-capita-1\nhttps://datacatalog.worldbank.org/total-final-energy-consumption-tfec\n\nNot clear from either measure what it contains -e.g. presumably it doesn't contain energy embodied in imported goods?\n"]);return Re=function(){return e},e}function Ie(){var e=Object(o.a)(["# Derive energy usage country comparisons"]);return Ie=function(){return e},e}function Pe(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(Ie())})),n.variable(t()).define(["md"],(function(e){return e(Re())})),n.variable(t("d3")).define("d3",["require"],(function(e){return e("d3")})),n.variable(t()).define(["md"],(function(e){return e(ze())})),n.variable(t("url")).define("url",(function(){return"https://gist.githubusercontent.com/RobinL/f9d478dadd70ec2dda67c1e9e91686f1/raw/1d628cb38f3d693052bf6bf5eedcb4126bf34a25/energy_usage.csv"})),n.variable(t("data")).define("data",["d3","url"],(function(e,t){return e.csv(t,e.autoType)})),n.variable(t("nonnull_data")).define("nonnull_data",["data"],(function(e){return e.filter((function(e){return".."!=e["2014 [YR2014]"]}))})),n.variable(t("data_by_country")).define("data_by_country",["nonnull_data"],(function(e){return e.map((function(e){var t={};return t["2014_kg_oil_equiv_per_capita"]=e["2014 [YR2014]"],t.country=e["Country Name"],t.code=e["Country Code"],t}))})),n.variable(t("data_with_kwh")).define("data_with_kwh",["data_by_country"],(function(e){return e.map((function(e){return e.kwh_per_day=11.63*e["2014_kg_oil_equiv_per_capita"]/365,{kwh_per_day:e.kwh_per_day,code:e.code,country:e.country}}))})),n.variable(t("countries")).define("countries",(function(){return["USA","GBR","CHN","FRA","BRA","IND","AUS"]})),n.variable(t("selected_countries")).define("selected_countries",["data_with_kwh","countries"],(function(e,t){return e.filter((function(e){return t.includes(e.code)}))})),n.variable(t()).define(["selected_countries"],(function(e){return JSON.stringify(e)})),n.variable(t("primary_energy_use_data_pc")).define("primary_energy_use_data_pc",["d3"],(function(e){return e.json("https://cors-anywhere.herokuapp.com/http://api.worldbank.org/countries/USA;GBR;CHN;FRA;BRA;IND;AUS/indicators/EG.USE.PCAP.KG.OE?date=2014%3A2014&format=json&per_page=1000")})),n.variable(t("tfec_data")).define("tfec_data",["d3"],(function(e){return e.json("https://cors-anywhere.herokuapp.com/http://api.worldbank.org/countries/USA;GBR;CHN;FRA;BRA;IND;AUS/indicators/1.1_TOTAL.FINAL.ENERGY.CONSUM?date=2014%3A2014&format=json&per_page=1000")})),n.variable(t("population_data")).define("population_data",["d3"],(function(e){return e.json("https://cors-anywhere.herokuapp.com/http://api.worldbank.org/countries/USA;GBR;CHN;FRA;BRA;IND;AUS/indicators/SP.POP.TOTL?date=2014%3A2014&format=json&per_page=1000")})),n.variable(t("final_energy_use_per_capita_data")).define("final_energy_use_per_capita_data",["tfec_data","population_data"],(function(e,t){return[0,1,2,3,4,5,6].map((function(n){return{code:e[1][n].country.id,country:e[1][n].country.value,kwh_per_day:1e12*e[1][n].value/(36e5*t[1][n].value)/365.25}}))})),n.variable(t("primary_energy_use_per_capita_data")).define("primary_energy_use_per_capita_data",["primary_energy_use_data_pc"],(function(e){return e[1].map((function(e){return e.kwh_per_day=11.63*e.value/365,{kwh_per_day:e.kwh_per_day,code:e.country.id,country:e.country.value}}))}));var i=e.module(Ne);return n.import("vl",i),n.variable(t("vega_embed")).define("vega_embed",["require"],(function(e){return e("vega-embed@3")})),n.variable(t("primary_energy_use_per_capita")).define("primary_energy_use_per_capita",["vega_embed","primary_energy_use_per_capita_data"],(function(e,t){return e({data:{values:t},mark:"bar",encoding:{x:{field:"country",type:"nominal",sort:{field:"kwh_per_day",op:"mean",order:"descending"}},y:{field:"kwh_per_day",type:"quantitative"}}})})),n.variable(t("final_energy_use_per_capita")).define("final_energy_use_per_capita",["vega_embed","final_energy_use_per_capita_data"],(function(e,t){return e({data:{values:t},mark:"bar",encoding:{x:{field:"country",type:"nominal",sort:{field:"kwh_per_day",op:"mean",order:"descending"}},y:{field:"kwh_per_day",type:"quantitative"}}})})),n}function Me(){var e=Object(o.a)(["<a href>"]);return Me=function(){return e},e}function Fe(){var e=Object(o.a)(["## Annex: Imports and Calculations"]);return Fe=function(){return e},e}function We(){var e=Object(o.a)(["The following chart shows final energy consumption per capita."]);return We=function(){return e},e}function Be(){var e=Object(o.a)(['Note that primary energy usage is __not__ equivalent to the end-user consumption tallied in this calculator.\n\nIt is [defined as](https://ec.europa.eu/eurostat/statistics-explained/index.php/Glossary:Primary_energy_consumption) "The total energy demand of a country. It covers consumption of the energy sector itself, losses during transformation (for example, from oil or gas into electricity) and distribution of energy, and the final consumption by end users". \n\nI think this means it would count both energy produced domestically and primary energy imports in the form of fuel.  But not energy embodied in imported goods.  It is unclear to me whether it would count jet fuel oil for international flights.']);return Be=function(){return e},e}function He(){var e=Object(o.a)(["The following chart shows primary per capita energy usage, converted into kwh.  See [here](https://datacatalog.worldbank.org/energy-use-kg-oil-equivalent-capita-1) for the source of the data.  "]);return He=function(){return e},e}function Ue(){var e=Object(o.a)(["This calculator only considers a subset of your energy usage, so your overall total will actually be higher.  Nonetheless, it's interesting to compare to average per captia energy usage of various countries:"]);return Ue=function(){return e},e}function Ce(){var e=Object(o.a)(["## How do you compare?"]);return Ce=function(){return e},e}function Ye(){var e=Object(o.a)(["Here's another representation of how your energy usage breaks down:"]);return Ye=function(){return e},e}function Ke(){var e=Object(o.a)(["# Summary"]);return Ke=function(){return e},e}function Qe(){var e=Object(o.a)(["## [Pets](https://github.com/RobinL/energy_usage/blob/master/src/pets.js)"]);return Qe=function(){return e},e}function Je(){var e=Object(o.a)(["## [Eating](https://github.com/RobinL/energy_usage/blob/master/src/eating.js)"]);return Je=function(){return e},e}function Ze(){var e=Object(o.a)(["## [Stuff](https://github.com/RobinL/energy_usage/blob/master/src/stuff.js)"]);return Ze=function(){return e},e}function Xe(){var e=Object(o.a)(["## [Electricity](https://github.com/RobinL/energy_usage/blob/master/src/electricity.js)"]);return Xe=function(){return e},e}function $e(){var e=Object(o.a)(["## [Showers/baths](https://github.com/RobinL/energy_usage/blob/master/src/shower.js)"]);return $e=function(){return e},e}function et(){var e=Object(o.a)(["## [Heating](https://github.com/RobinL/energy_usage/blob/master/src/heating.js)"]);return et=function(){return e},e}function tt(){var e=Object(o.a)(["## [Flying](https://github.com/RobinL/energy_usage/blob/master/src/flying.js)"]);return tt=function(){return e},e}function nt(){var e=Object(o.a)(["## [Driving](https://github.com/RobinL/energy_usage/blob/master/src/driving.js)"]);return nt=function(){return e},e}function it(){var e=Object(o.a)(["## Key to graphics"]);return it=function(){return e},e}function rt(){var e=Object(o.a)(["This is a __rough ready reckoner__ to help you understand your personal energy consumption. \n\nI'm sure these estimates could be significantly improved - suggestions gratefully received [here](https://github.com/RobinL/energy_usage/pulls).\n\nFollowing, [David MacKay](https://www.withouthotair.com/c2/page_24.shtml), I standardise everything in kilowatt hours. \n\nYou can find all assumptions and calculations [here](https://github.com/RobinL/energy_usage/tree/master/src), or click on the headers for calculations specific to each activity.\n"]);return rt=function(){return e},e}function at(){var e=Object(o.a)(["# Energy usage ready reckoner for everyday activities"]);return at=function(){return e},e}function ot(e,t){var n=e.module();n.variable(t("title")).define("title",["md"],(function(e){return e(at())})),n.variable(t("under_title_blurb")).define("under_title_blurb",["md"],(function(e){return e(rt())})),n.variable(t("key_to_graphics_title")).define("key_to_graphics_title",["md"],(function(e){return e(it())})),n.variable(t("key_to_graphics_text")).define("key_to_graphics_text",["key"],(function(e){return e})),n.variable(t("driving_title")).define("driving_title",["md"],(function(e){return e(nt())})),n.variable(t("driving_text_output")).define("driving_text_output",["driving_text"],(function(e){return e})),n.variable(t("driving_chart_output")).define("driving_chart_output",["driving_chart"],(function(e){return e})),n.variable(t("flying_title")).define("flying_title",["md"],(function(e){return e(tt())})),n.variable(t("flying_text_output")).define("flying_text_output",["flying_text"],(function(e){return e})),n.variable(t("flying_chart_output")).define("flying_chart_output",["flying_chart"],(function(e){return e})),n.variable(t("heating_title")).define("heating_title",["md"],(function(e){return e(et())})),n.variable(t("heating_text_output")).define("heating_text_output",["heating_text"],(function(e){return e})),n.variable(t("heating_chart_output")).define("heating_chart_output",["heating_chart"],(function(e){return e})),n.variable(t("showers_baths_title")).define("showers_baths_title",["md"],(function(e){return e($e())})),n.variable(t("showers_baths_text_output")).define("showers_baths_text_output",["showers_and_baths_text"],(function(e){return e})),n.variable(t("showers_bath_chart_output")).define("showers_bath_chart_output",["showers_bath_chart"],(function(e){return e})),n.variable(t("electricity_title")).define("electricity_title",["md"],(function(e){return e(Xe())})),n.variable(t("electricity_text_output")).define("electricity_text_output",["electricity_text"],(function(e){return e})),n.variable(t("electricity_chart_output")).define("electricity_chart_output",["electricity_chart"],(function(e){return e})),n.variable(t("stuff_title")).define("stuff_title",["md"],(function(e){return e(Ze())})),n.variable(t("stuff_text_output")).define("stuff_text_output",["stuff_text"],(function(e){return e})),n.variable(t("stuff_chart_output")).define("stuff_chart_output",["stuff_chart"],(function(e){return e})),n.variable(t("eating_title")).define("eating_title",["md"],(function(e){return e(Je())})),n.variable(t("eating_text_output")).define("eating_text_output",["eating_text"],(function(e){return e})),n.variable(t("eating_chart_output")).define("eating_chart_output",["eating_chart"],(function(e){return e})),n.variable(t("dogs_title")).define("dogs_title",["md"],(function(e){return e(Qe())})),n.variable(t("dogs_text_output")).define("dogs_text_output",["dogs_text"],(function(e){return e})),n.variable(t("dogs_chart_output")).define("dogs_chart_output",["dogs_chart"],(function(e){return e})),n.variable(t("summary_title")).define("summary_title",["md"],(function(e){return e(Ke())})),n.variable(t("summary_text_output")).define("summary_text_output",["summary_text","all_data"],(function(e,t){return e(t)})),n.variable(t("summary_chart_output")).define("summary_chart_output",["unit_chart_2","all_data_dict"],(function(e,t){return e(t)})),n.variable(t("summary_text_output_2")).define("summary_text_output_2",["md"],(function(e){return e(Ye())})),n.variable(t("energy_use_treemap")).define("energy_use_treemap",["treemap_chart","all_data","width"],(function(e,t,n){return e(t,n,!0)})),n.variable(t()).define(["md"],(function(e){return e(Ce())})),n.variable(t("md_notinclude")).define("md_notinclude",["md"],(function(e){return e(Ue())})),n.variable(t()).define(["md"],(function(e){return e(He())})),n.variable(t()).define(["primary_energy_use_per_capita"],(function(e){return e})),n.variable(t()).define(["md"],(function(e){return e(Be())})),n.variable(t()).define(["md"],(function(e){return e(We())})),n.variable(t()).define(["final_energy_use_per_capita"],(function(e){return e})),n.variable(t()).define(["md"],(function(e){return e(Fe())})),n.variable(t("all_data")).define("all_data",["driving_data","flying_data","electricity_data","eating_data","dogs_data","heating_gas_data","stuff_data"],(function(e,t,n,i,r,a,o){return e.concat(t,n,i,r,a,o)})),n.variable(t("all_data_dict")).define("all_data_dict",["all_data"],(function(e){var t={};return e.forEach((function(e){return t[e.name]=e.value})),t}));var i=e.module(C);n.import("driving_text",i),n.import("driving_conclusion",i),n.import("driving_data",i),n.import("driving_chart",i);var o=e.module(J);n.import("flying_text",o),n.import("flying_chart",o),n.import("flying_data",o);var u=e.module(ee);n.import("electricity_text",u),n.import("electricity_conclusion",u),n.import("electricity_data",u),n.import("electricity_chart",u);var c=e.module(re);n.import("dogs_text",c),n.import("dogs_conclusion",c),n.import("dogs_data",c),n.import("dogs_chart",c);var l=e.module(de);n.import("eating_text",l),n.import("eating_conclusion",l),n.import("eating_data",l),n.import("eating_chart",l);var f=e.module(be);n.import("heating_text",f),n.import("showers_and_baths_text",f),n.import("heating_gas_data",f),n.import("heating_chart",f),n.import("showers_bath_chart",f);var s=e.module(xe);n.import("stuff_text",s),n.import("stuff_conclusion",s),n.import("stuff_data",s),n.import("stuff_chart",s);var d=e.module(Ae);n.import("treemap_chart",d),n.import("summary_text",d);var v=e.module(Pe);n.import("primary_energy_use_per_capita",v),n.import("final_energy_use_per_capita",v);var _=e.module(W);n.import("key",_),n.variable(t("ga")).define("ga",["require","html"],function(){var e=Object(a.a)(r.a.mark((function e(t,n){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("https://www.google-analytics.com/analytics.js").catch((function(){return window.ga}));case 2:return(i=e.sent)("create","UA-146468274-1","auto"),i("send","pageview",n(Me()).pathname),e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());var h=e.module(W);return n.import("unit_chart",h),n.import("unit_chart_2",h),n}var ut=n("56Sw"),ct=n("qKvR");n.d(t,"frontmatter",(function(){return lt}));var lt={title:"Energy usage ready reckoner",post_date:"2019-10-05",code_url:"https://observablehq.com/@robinl/energy-usage-calculator-for-everyday-activities",post_type:"obs",post_category:"energy"},ft=["title","under_title_blurb","key_to_graphics_title","key_to_graphics_text","driving_title","driving_text_output","driving_chart_output","flying_title","flying_text_output","flying_chart_output","heating_title","heating_text_output","heating_chart_output","showers_baths_title","showers_baths_text_output","showers_bath_chart_output","electricity_title","electricity_text_output","electricity_chart_output","stuff_title","stuff_text_output","stuff_chart_output","showers_title","showers_text_output","showers_chart_output","eating_title","eating_text_output","eating_chart_output","washing_title","washing_text_output","washing_chart_output","dogs_title","dogs_text_output","dogs_chart_output","summary_title","summary_text_output","summary_chart_output","summary_text_output_2","energy_use_treemap"];t.default=function(e){e.data;return Object(ct.c)(ut.a,{define:ot,output_order:ft,post_frontmatter:lt})}}}]);
//# sourceMappingURL=component---src-pages-energy-usage-jsx-a0f9d93e847de987c7b4.js.map